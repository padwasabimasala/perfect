#!/bin/bash

dir=~/.perfect

case $1 in
  destroy)
    rm -Rf $dir
    echo Deleted $dir
    exit
  ;;
  *) ;;
esac

if test -e $dir; then
  echo Perfect aready installed. Delete $dir and run again. >&2
  exit 1
else
  mkdir -p $dir
  cd $dir
  curl -LOks https://github.com/octanner/perfect/archive/master.zip
  unzip master.zip
  rm master.zip
  cp -r perfect-master/bin .
  rm -Rf perfect-master
  if test -e ~/.zshrc; then
    echo "Adding PATH and alias to ~/.zshrc"
    echo 'export PATH=$PATH:'$dir'/bin' >> ~/.zshrc
    echo "alias perfect='source $dir/bin/perfect'" >> ~/.zshrc
  else
    echo "Adding PATH and alias to ~/.bashrc"
    echo 'export PATH=$PATH:'$dir'/bin' >> ~/.bashrc
    echo "alias perfect='source $dir/bin/perfect'" >> ~/.bashrc
  fi
  echo Perfect installed to $dir
  exit
fi
